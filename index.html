<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UNESCO 世界遗产交互探索</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
</head>
<body>
  <header>
    <div class="title-block">
      <h1>UNESCO 世界遗产交互探索</h1>
      <p>从 1978 年以来的全量 whc001 数据出发，联动揭示空间分布、年度节律、类别结构与濒危轨迹。</p>
    </div>
    <div class="highlight-panels">
      <div class="panel" id="summary-counts"></div>
      <div class="panel" id="sunburst-breadcrumb">全部区域</div>
    </div>
  </header>

  <section class="controls">
    <div class="control-group">
      <label for="yearSlider">年份滑条</label>
      <div class="slider-wrapper">
        <button id="playToggle" aria-label="播放或暂停时间轴">▶︎</button>
        <input type="range" id="yearSlider" min="1978" max="2024" value="2024" />
        <span id="yearValue">2024</span>
      </div>
    </div>
    <div class="control-group">
      <label for="viewMode">时间线分组</label>
      <select id="viewMode">
        <option value="category">按类别 (文化/自然/混合)</option>
        <option value="region">按区域 (UNESCO 区域)</option>
      </select>
    </div>
    <div class="control-group criteria">
      <div class="criteria-header">
        <span>入选标准 (i–x)</span>
        <button id="criteriaMode" data-mode="OR">模式：包含任一</button>
      </div>
      <div id="criteriaList" class="criteria-grid"></div>
    </div>
    <div class="control-group">
      <label for="searchInput">搜索国家 / 站点</label>
      <input type="text" id="searchInput" list="searchOptions" placeholder="输入关键词..." />
      <datalist id="searchOptions"></datalist>
    </div>
    <div class="control-inline">
      <label><input type="checkbox" id="dangerOnly" /> 仅显示濒危站点</label>
      <label><input type="checkbox" id="andDangerEvents" checked /> 时间线叠加濒危事件</label>
    </div>
  </section>

  <main>
    <section class="view" id="mapView">
      <div class="view-header">
        <h2>全球分布 (Equal Earth)</h2>
        <p>颜色＝类别；描边＝濒危状态；透明度＆描边高亮＝时间刷选。</p>
      </div>
      <div class="view-body">
        <svg id="map"></svg>
        <div id="mapLegend" class="legend"></div>
      </div>
    </section>

    <section class="view" id="timelineView">
      <div class="view-header">
        <h2>年度新增节律</h2>
        <p>刷选时间区间以高亮地图点；折线显示濒危事件 (Y=列入, R=移除)。</p>
      </div>
      <div class="view-body">
        <svg id="timeline"></svg>
        <div class="legend" id="timelineLegend"></div>
      </div>
    </section>

    <section class="view" id="sunburstView">
      <div class="view-header">
        <h2>区域 → 国家 → 类别 结构</h2>
        <p>点击扇区过滤其他视图，再次点击返回上一层。</p>
      </div>
      <div class="view-body">
        <svg id="sunburst"></svg>
      </div>
    </section>
  </main>

  <div id="tooltip" class="tooltip" role="tooltip" hidden></div>

  <footer>
    数据来源：<a href="https://whc.unesco.org/" target="_blank" rel="noopener noreferrer">UNESCO World Heritage Centre</a> ｜ 可视化：D3.js。
  </footer>

  <script type="module" src="app.js"></script>
</body>
</html>
